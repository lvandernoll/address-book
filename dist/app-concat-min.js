window.onload=(()=>{new Controller});class Controller{constructor(){this.view=new View,this.footerIcons=document.querySelectorAll(".footer__image"),this.searchBar=document.querySelector("#searchBar");this.peopleArray=[],this.loadPeople(20),this.view.setPageTransition("1s"),this.setFooterIcons(),this.setSearchBar()}loadPeople(e){fetch(`https://randomuser.me/api/?nat=nl&inc=picture,name,phone,cell,email&results=${e}`).then(e=>e.json()).then(e=>{this.peopleArray=e.results.sort((e,t)=>e.name.first>t.name.first?1:t.name.first>e.name.first?-1:0),this.peopleArray.forEach(e=>{e.name.full=`${e.name.first} ${e.name.last}`}),this.view.showPeopleList(this.peopleArray),this.view.setLetterList(),this.view.fillDetailPage(this.peopleArray[0])}).catch(e=>console.error(e))}setFooterIcons(){this.footerIcons.forEach(e=>{e.addEventListener("click",e=>{this.peopleList=document.querySelector("#peopleList"),this.footerIcons.forEach(e=>{e.classList.remove("footer__image--selected")}),e.target.classList.add("footer__image--selected")})})}setSearchBar(){this.searchBar.addEventListener("input",()=>{if(""===this.searchBar.value)return this.view.showPeopleList(this.peopleArray);let e=[];this.peopleArray.forEach(t=>{t.name.full.includes(this.searchBar.value)&&e.push(t)}),this.view.showPeopleList(e),this.view.setLetterList()})}}class Person{constructor(e,t,i){const s=document.querySelector("#personTemplate").cloneNode(!0);return s.classList.remove("hidden"),s.querySelector(".person__image").src=e,s.querySelector(".person__name").innerText=t,s.querySelector(".person__phone-number").innerText=i,s}}class View{constructor(){this.detailPage=document.querySelector("#detailPage"),this.contactsPage=document.querySelector("#contactsPage"),this.peopleList=document.querySelector("#peopleList"),this.lineTemplate=document.querySelector("#lineTemplate"),this.letterList=document.querySelectorAll(".letter-list__letter"),this.detailActive=!1,this.transitionTime,this.allFirstLetters=[],this.peopleListTemplates=[],this.peopleList.childNodes.forEach(e=>{this.peopleListTemplates.push(e)}),document.querySelector("#returnButton").addEventListener("click",()=>{this.switchDetailPage()})}showPeopleList(e){this.allFirstLetters=[];let t="";this.peopleList.innerHTML="",this.peopleListTemplates.forEach(e=>{this.peopleList.appendChild(e)}),e.forEach(e=>{let i=!0;this.allFirstLetters.forEach(t=>{e.name.first[0]===t&&(i=!1)}),i&&this.allFirstLetters.push(e.name.first[0]);let s=new Person(e.picture.large,e.name.full,e.phone);if(e.name.first[0]!==t){s.classList.toggle("person-block--no-border");const i=this.lineTemplate.cloneNode(!0);i.classList.remove("hidden"),i.querySelector(".person-line__letter").innerText=e.name.first[0],i.querySelector(".person-line__letter").setAttribute("id",e.name.first[0]),this.peopleList.appendChild(i),t=e.name.first[0]}s.addEventListener("click",()=>{this.fillDetailPage(e),this.switchDetailPage()}),this.peopleList.appendChild(s)})}setLetterList(){this.letterList.forEach(e=>{let t=!1;this.allFirstLetters.forEach(i=>{e.innerHTML===i&&(t=!0)}),t?(e.setAttribute("href",`#${e.innerHTML}`),e.classList.remove("letter-list__letter--faded")):(e.removeAttribute("href"),e.classList.add("letter-list__letter--faded"))})}fillDetailPage(e){this.detailPage.querySelector("#detailImage").style.backgroundImage=`url(${e.picture.large})`,this.detailPage.querySelector("#detailName").innerText=e.name.full,this.detailPage.querySelector("#detailFunction").innerText="Designer at Competa",this.detailPage.querySelector("#detailMobilePhone").innerText=e.cell,this.detailPage.querySelector("#detailWorkPhone").innerText=e.phone,this.detailPage.querySelector("#detailWorkMail").innerText=e.email,this.detailPage.querySelector("#detailPersonalMail").innerText=e.email}switchDetailPage(){this.detailActive?(this.detailPage.style.left="-150%",this.contactsPage.style.height="84vh"):(this.detailPage.style.left="0",setTimeout(()=>{this.contactsPage.style.height="0"},this.transitionTime)),this.detailActive=!this.detailActive}setPageTransition(e){this.transitionTime=1e3*e.replace(/s/,""),this.detailPage.style.transition=`left ${e} ease`}}